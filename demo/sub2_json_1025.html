<html> <head> <meta charset="UTF-8"><meta http-equiv="refresh" content="1"><script type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script> <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/echarts/5.1.2/echarts.min.js"></script><script type="text/javascript" src="./roslibjs/build/roslib.min.js"></script> <script type="text/javascript" src="jquery-1.9.1.min.js"></script> <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><style>.main { width: 100%; height: 100%; margin: 0 auto}</style></head><body><div id="main" class="main"></div><script type="text/javascript">function readTextFile(file){ var rawFile = new XMLHttpRequest(); rawFile.open("GET", file, false); rawFile.onreadystatechange = function () { if(rawFile.readyState === 4) { if(rawFile.status === 200 || rawFile.status == 0) {       var allText = rawFile. responseText;  alert(allText);}} }; rawFile.send(null);  }  var data =[{'head': '木门槛', 'tail': '场景', 'relation': '类型是'}, {'head': '木门槛', 'tail': '障碍物', 'relation': '是'}, {'head': '木门槛', 'tail': '行走', 'relation': '不可以'}, {'head': '木门槛', 'tail': '跨越', 'relation': '容易'}, {'head': '木门槛', 'tail': '0.8cm', 'relation': '跨越时建议迈高'}, {'head': '木门槛', 'tail': '20.5cm', 'relation': '跨越时建议步长'}, {'head': '木门槛', 'tail': '绕行', 'relation': '不可以'}, {'head': '木门槛', 'tail': '踩踏', 'relation': '容易'}, {'head': '木门槛', 'tail': '台阶', 'relation': '无'}, {'head': '木门槛', 'tail': '0.8cm', 'relation': '踩踏时建议迈高'}, {'head': '木门槛', 'tail': '较坚实', 'relation': '踏面松软度'}, {'head': '木门槛', 'tail': '较狭窄', 'relation': '踏面面积'}, {'head': '木门槛', 'tail': '双脚站立时平衡', 'relation': '容易'}, {'head': '木门槛', 'tail': '门槛', 'relation': '是'}, {'head': '木门槛', 'tail': '矩形', 'relation': '形状'}, {'head': '木门槛', 'tail': '材质', 'relation': '木质'}, {'head': '木门槛', 'tail': '障碍', 'relation': '是'}, {'head': '木门槛', 'tail': '阻隔', 'relation': '可用作'}, {'head': '木门槛', 'tail': '水泥地', 'relation': '位于'}, {'head': '木门槛', 'tail': '斜坡', 'relation': '前方'}, {'head': '水泥地', 'tail': '地面', 'relation': '类型是'}, {'head': '水泥地', 'tail': '障碍物', 'relation': '不是'}, {'head': '水泥地', 'tail': '行走', 'relation': '可以'}, {'head': '水泥地', 'tail': '35cm', 'relation': '行走时建议步长'}, {'head': '水泥地', 'tail': '凹凸', 'relation': '路面平整度'}, {'head': '水泥地', 'tail': '抗滑', 'relation': '路面摩擦度'}, {'head': '水泥地', 'tail': '一般', 'relation': '路面松软度'}, {'head': '水泥地', 'tail': '地面', 'relation': '是'}, {'head': '水泥地', 'tail': '地形', 'relation': '是'}, {'head': '水泥地', 'tail': '美化', 'relation': '可用作'}, {'head': '水泥地', 'tail': '步行', 'relation': '可用作'}, {'head': '水泥地', 'tail': '单步行走', 'relation': '可用作'}, {'head': '水泥地', 'tail': '路面变化', 'relation': '导致'}, {'head': '水泥地', 'tail': '坚硬', 'relation': '具有特性'}, {'head': '水泥地', 'tail': '干燥', 'relation': '具有特性'}, {'head': '水泥地', 'tail': '灰色', 'relation': '具有特性'}, {'head': '水泥地', 'tail': '粗糙', 'relation': '具有特性'}, {'head': '水泥地', 'tail': '可行走', 'relation': '具有特性'}, {'head': '水泥地', 'tail': '户外', 'relation': '位于'}, {'head': '水泥地', 'tail': '水泥地面', 'relation': '同义词'}];var obj_head_list_0 = ['路边椅子', '花池', '楼梯', '斜坡', '小石头', '草地', '沙地', '水泥地', '木门槛', '鹅卵石地面', '砖头', '柱子']; var attr_tail_list_1 = ['场景', '障碍物', '行走', '跨越', '绕行', '踩踏', '台阶', '15cm', '坚实', '宽阔', '双脚站立时平衡', '坐下', '四面均可', '扶手', '靠背', '双脚触地', '移动', '一般', '地形', '较坚实', '较狭窄', '29.75cm', '平整', '较滑', '<=3', '小障碍', '26cm', '地面', '24.5cm', '凹凸', '易凹陷', '35cm', '抗滑', '0.8cm', '20.5cm', '狭窄', '大障碍', '向上', '向下', '右方', '左方'];  var common_tail_list_2 = ['门槛', '矩形', '材质', '障碍', '阻隔', '建筑', '长方体', '装饰', '承重', '椅子', '公共设施', '长椅', '坐下', '休息', '美观', '坚硬', '路边', '马路', '区域', '构造物', '疏导', '美化', '遮挡', '可绕过', '公园', '草地', '户外', '楼梯', '地貌', '地形', '步行', '上坡', '下坡', '单步上坡', '单步下坡', '倾斜', '可上坡', '可下坡', '岩石', '凝结物', '建造', '铺垫', '水泥地', '地面', '植被', '路面变化', '柔软', '潮湿', '不平整', '绿色', '吸水', '可行走', '草坪', '干燥', '黄色', '流动', '粗糙', '沙土地', '鹅卵石地', '单步行走', '灰色', '水泥地面', '转弯', '动作', '向左', '站立', '稳定', '不稳定', '向左转', '向右', '向右转', '变速（加减速）', '快速', '慢速', '上楼梯', '升高', '在楼上', '抬腿', '在楼下', '下楼梯', '降低', '在坡上', '斜坡', '在坡下', '跨越', '小石头', '坐着', '行走', '站起', '方向变换', '转向', '静止', '停下', '单步跨越', '单步上楼梯', '单步下楼梯', '坐具', '坐', '落座', '上楼', '下楼', '交通', '连接', '可上楼', '可下楼', '指挥', '摔倒', '走路', '室内', '石头墩子']; var categories = []; for (var i = 0; i < 3; i++) { categories[i] = {   name: '类目' + i }; var categories = []; for (var i = 0; i < 3; i++) { categories[i] = { name: '类目' + i };} var nodeAndLinks = genNodeData(data); renderChart(nodeAndLinks[0], nodeAndLinks[1]);} function genNodeData(input_message) { info_string1 = ""; info_string2 = ""; var messages = input_message;	 var a = ""; var key_ind = []; var name_ind = []; var category_ind = [];  var head_ind = []; var tail_ind = []; var relation_ind = []; let nodes = []; let links = []; for (k = 0; k < messages.length; k++) { message = messages[k]; head_ind[head_ind.length] = message.head; tail_ind[tail_ind.length] = message.tail; relation_ind[relation_ind.length] = message.relation; for (i = 0; i < 2; i++) { if (name_ind.findIndex(value => value === Object.values(message)[i]) === -1) { key_ind[key_ind.length] = Math.random().toString(16);  name_ind[name_ind.length] = Object.values(message)[i]; if (!(obj_head_list_0.findIndex(value => value === Object.values(message)[i]) === -1)) { category_ind[category_ind.length] = 0 } else { if (!(common_tail_list_2.findIndex(value => value === Object.values(message)[i]) === -1)) { category_ind[category_ind.length] = 2 } else {category_ind[category_ind.length] = 1}  } } } }  for (let i = 0; i < key_ind.length; i++) { let color = getColorByCategory(category_ind[i]); nodes.push({  id: key_ind[i], name: name_ind[i], symbolSize: category_ind[i] === 0 ? 90 : 50,  category: category_ind[i],   itemStyle: { color: color  } }) } for (let i = 0; i < head_ind.length; i++) { let color = getColorByNodeId(nodes, key_ind[name_ind.findIndex(value => value === tail_ind[i])]); links.push({ source: key_ind[name_ind.findIndex(value => value === head_ind[i])], target: key_ind[name_ind.findIndex(value => value === tail_ind[i])],  name: relation_ind[i], lineStyle: { color: color } }) } return [nodes, links]} function getColorByCategory(category) {  if (category === 0) { return '#5470C6' } else if (category === 1) { return '#FAC858' } else { return '#9FE080'}} function getColorByNodeId(nodes, nodeId) { return nodes.filter(r => r.id === nodeId)[0].itemStyle.color } function renderChart(nodeData, linkData) { var chartDom = document.getElementById('main'); var myChart = echarts.init(chartDom); var option; option = { title: { text: ''}, tooltip: { formatter: function (x) { return x.data.label; } }, toolbox: { show: true, feature: { mark: { show: true}, restore: { show: true }, saveAsImage: { show: true}} }, legend: [{ data: categories.map(function (a) { return a.name;  }) }], force:{   repulsion: 2500,  friction: 0.3, edgeLength: [10,50] }, series: [{  name: 'echart', zoom: 0.3, scaleLimit: { min: 0.1, max: 3, }, type: 'graph',  layout: 'force',  symbolSize: 40,  roam: true,   edgeSymbol: ['circle', 'arrow'],  edgeSymbolSize: [2, 15],    animationDuration: 0.001,   animationEasingUpdate: "quinticInOut",     darkMode: 'auto', animation: "auto",  animationDurationUpdate: 50, animationThreshold: 2000, progressiveThreshold: 3000,  progressive: 400,   hoverLayerThreshold: 3000, stateAnimation: { duration: 300, easing: 'cubinOut' }, edgeLabel: {  normal: { textStyle: { fontSize: 20} } }, force: {repulsion: 2500, edgeLength: [10, 50] }, draggable: true,  lineStyle: { normal: { width: 5,  color: 'source', curveness: 0.3} }, emphasis: { focus: 'adjacency',lineStyle: { width: 10 } }, edgeLabel: { normal: { show: true, formatter: function (x) {return x.data.name; }}  }, label: { normal: { show: true, textStyle: {} }  }, data: nodeData,  links: linkData, categories: ['0', '1', '2'] }] }; option && myChart.setOption(option); }</script></body></html>